name: Test Self-Hosted Runner

on:
  workflow_dispatch:

jobs:
  test:
    name: Test Runner & Cluster Access
    runs-on: self-hosted
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Check runner environment
        run: |
          echo "🖥️ Runner information:"
          echo "Hostname: $(hostname)"
          echo "OS: $(uname -s)"
          echo "Working directory: $(pwd)"
      
      - name: Verify kubectl access
        run: |
          echo "🔍 Checking Kubernetes access..."
          kubectl version --client
          kubectl config current-context
      
      - name: List Kubernetes namespaces
        run: |
          echo "📦 Kubernetes namespaces:"
          kubectl get namespaces
      
      - name: Check our environments
        run: |
          echo "✅ Checking lab environments:"
          kubectl get namespace dev staging prod
      
      - name: Success!
        run: |
          echo "🎉 Runner is working and has cluster access!"
